//
//  WorkCellB.m
//  IDLook
//
//  Created by HYH on 2018/5/18.
//  Copyright © 2018年 HYH. All rights reserved.
//

#import "WorkCellB.h"

@interface WorkCellB ()
@property(nonatomic,strong)UIImageView *icon;
@property(nonatomic,strong)UILabel *titleLab;
@property(nonatomic,strong)UILabel *typeLab;
@property(nonatomic,strong)UIView *typeView;
@property(nonatomic,strong)UIButton *selectBtn;
@property(nonatomic,strong)WorksModel *model;
@property(nonatomic,strong)UIButton *statusBtn;

@end

@implementation WorkCellB


-(UIImageView*)icon
{
    if (!_icon) {
        _icon=[[UIImageView alloc]init];
        [self.contentView addSubview:_icon];
        _icon.layer.cornerRadius=5.0;
        _icon.layer.masksToBounds=YES;
        _icon.userInteractionEnabled=YES;
        _icon.contentMode=UIViewContentModeScaleAspectFill;
        _icon.backgroundColor=[UIColor blackColor];
        [_icon mas_makeConstraints:^(MASConstraintMaker *make) {
            make.left.mas_equalTo(self.contentView);
            make.right.mas_equalTo(self.contentView);
            make.top.mas_equalTo(self.contentView);
            make.bottom.mas_equalTo(self.contentView).offset(-55);
        }];
        
        UITapGestureRecognizer *tap =[[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(selectAction)];
        [_icon addGestureRecognizer:tap];
    }
    return _icon;
}


-(UILabel*)titleLab
{
    if (!_titleLab) {
        _titleLab=[[UILabel alloc]init];
        [self.contentView addSubview:_titleLab];
        _titleLab.font=[UIFont systemFontOfSize:13];
        _titleLab.textColor=Public_Text_Color;
        [_titleLab mas_makeConstraints:^(MASConstraintMaker *make) {
            make.left.mas_equalTo(self.contentView);
            make.top.mas_equalTo(self.icon.mas_bottom).offset(8);
            make.right.mas_equalTo(self.contentView).offset(-30);
        }];
    }
    return _titleLab;
}

-(UILabel*)typeLab
{
    if (!_typeLab) {
        _typeLab=[[UILabel alloc]init];
        [self.contentView addSubview:_typeLab];
        _typeLab.font=[UIFont boldSystemFontOfSize:13];
        _typeLab.textColor=Public_Red_Color;
        [_typeLab mas_makeConstraints:^(MASConstraintMaker *make) {
            make.top.mas_equalTo(self.icon.mas_bottom).offset(8);
            make.right.mas_equalTo(self.contentView).offset(-2);
        }];
    }
    return _typeLab;
}

-(UIButton*)selectBtn
{
    if (!_selectBtn) {
        _selectBtn=[UIButton buttonWithType:UIButtonTypeCustom];
        [_selectBtn setBackgroundImage:[UIImage imageNamed:@"works_click_normal"] forState:UIControlStateNormal];
        [_selectBtn setBackgroundImage:[UIImage imageNamed:@"works_click_select"] forState:UIControlStateSelected];
        [self.contentView addSubview:_selectBtn];
        [_selectBtn mas_makeConstraints:^(MASConstraintMaker *make) {
            make.top.mas_equalTo(self.contentView).offset(6);
            make.right.mas_equalTo(self.contentView).offset(-6);
        }];
        [_selectBtn addTarget:self action:@selector(selectAction) forControlEvents:UIControlEventTouchUpInside];
    }
    return _selectBtn;
}

-(UIButton*)statusBtn
{
    if (!_statusBtn) {
        _statusBtn=[UIButton buttonWithType:UIButtonTypeCustom];
        [self.contentView addSubview:_statusBtn];
        _statusBtn.enabled=NO;
        _statusBtn.titleLabel.font=[UIFont systemFontOfSize:10.0];
        [_statusBtn setTitle:@"审核中" forState:UIControlStateNormal];
        [_statusBtn setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
        [_statusBtn setBackgroundImage:[UIImage imageNamed:@"work_status"] forState:UIControlStateNormal];
        [_statusBtn setBackgroundImage:[UIImage imageNamed:@"work_status"] forState:UIControlStateDisabled];
        [_statusBtn mas_makeConstraints:^(MASConstraintMaker *make) {
            make.left.mas_equalTo(self.icon).offset(0);
            make.top.mas_equalTo(self.icon).offset(0);
        }];
    }
    return _statusBtn;
}

-(UIView*)typeView
{
    if (!_typeView) {
        _typeView=[[UIView alloc]init];
        [self.contentView addSubview:_typeView];
        [_typeView mas_makeConstraints:^(MASConstraintMaker *make) {
            make.left.mas_equalTo(self.contentView);
            make.right.mas_equalTo(self.contentView);
            make.bottom.mas_equalTo(self.contentView);
            make.top.mas_equalTo(self.titleLab.mas_bottom);
        }];
    }
    return _typeView;
}

-(void)reloadUIWithModel:(WorksModel*)model
{
    self.model=model;
    [self.icon sd_setImageWithUrlStr:model.url placeholderImage:[UIImage imageNamed:@"default_photo"]];
    self.titleLab.text=model.title;
    self.typeLab.text=model.type;
    if (model.isEdit) {
        self.selectBtn.hidden=NO;
    }
    else
    {
        self.selectBtn.hidden=YES;
    }
    
    if (model.isSelect) {
        self.selectBtn.selected=YES;
    }
    else
    {
        self.selectBtn.selected=NO;
    }
    
    if (model.status==0) {
        self.statusBtn.hidden=NO;
    }
    else
    {
        self.statusBtn.hidden=YES;
    }
    
    for (UIView *view in self.typeView.subviews) {
        [view removeFromSuperview];
    }
    
    if (model.keyword.length>0) {
        NSArray  *array = [model.keyword componentsSeparatedByString:@"|"];
        for (int i =0; i<array.count; i++) {
            UIButton *btn=[UIButton buttonWithType:UIButtonTypeCustom];
            [self.typeView addSubview:btn];
            btn.layer.cornerRadius=3.0;
            btn.layer.masksToBounds=YES;
            btn.backgroundColor=[UIColor colorWithHexString:@"#F7F7F7"];
            [btn setTitleColor:[UIColor colorWithHexString:@"#999999"] forState:UIControlStateNormal];
            btn.titleLabel.font=[UIFont systemFontOfSize:11.0];
            [btn setTitle:array[i] forState:UIControlStateNormal];
            [btn mas_makeConstraints:^(MASConstraintMaker *make) {
                make.left.mas_equalTo(self.contentView).offset(62*i);
                make.centerY .mas_equalTo(self.typeView);
                make.size.mas_equalTo(CGSizeMake(55, 23));
            }];
        }
    }
}

-(void)selectAction
{
    if (self.model.isEdit) {
        self.chooseAction(!self.selectBtn.selected);
    }
    else
    {
        self.playAction();
    }
    
}

@end
